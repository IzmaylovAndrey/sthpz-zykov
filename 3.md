# 3. Сценарии

## 3.1. Регистрация

**Основной актор**: Неавторизованный пользователь.
**Вспомогательный актор**: База данных, Система.
**Контекст использования**: Зарегистрироваться в системе.
**Предусловия**: Пользователь не имеет логина и пароля для входа в систему.
**Постусловия**: Пользователь может войти в систему (получает логин и пароль), а данные о нем добавляются в Базу данных пользователей (пользователь зарегистрирован).

**Сценарий 1**.
1.  Пользователь нажимает кнопку “Зарегистрироваться как студент”.
2.  Пользователь заполняет необходимые поля: 
    - Адрес электронный почты
    - ФИО
    - Учебная группа
    - Название учебного заведения
    - Пароль, который будет использоваться для авторизации
3.  Система осуществляет проверку корректности введенных данных:
    - Адрес электронной почты должен соответствовать стандарту RFC 5322;
    - ФИО не может быть пустой строкой;
    - Учебная группа не может быть пустой строкой;
    - Название учебного заведения не может быть пустой строкой;
    - Пароль не может иметь длину меньше 4 символов.
4.  Система записывает введённые пользователем данные в Базу данных пользователей, помечая его как неподтверждённого.
5.  Система отправляет на указанный адрес электронной почты письмо, содержащее специально сформированную гиперссылку.
6.  Пользователь переходит по данной гиперссылке.
7.  Система регистрирует переход и помечает данного пользователя как подтверждённого.
8.  Система предлагает пользователю авторизоваться под своей учётной записью.

**Сценарий 1a**:
1. Пользователь нажимает кнопку "Зарегистрироваться как преподаватель".
2.  Пользователь заполняет необходимые поля: 
    - Адрес электронный почты
    - ФИО
    - Название учебного заведения
    - Пароль, который будет использоваться для авторизации
3.  Система осуществляет проверку корректности введенных данных:
    - Адрес электронной почты должен соответствовать стандарту RFC 5322;
    - ФИО не может быть пустой строкой;
    - Название учебного заведения не может быть пустой строкой;
    - Пароль не может иметь длину меньше 4 символов.
4. Дальнейшие шаги соответствуют шагам 4.-8. **Сценария 1**.

**Сценарий 1b**:
1. В случае ввода некорректных данных пользователю будет предоставлено описание совершённых им ошибок.

## 3.2. Авторизация

**Основной актор**: Неавторизованный пользователь.
**Вспомогательный актор**: База данных, Система.
**Контекст использования**: Авторизоваться в системе.
**Предусловия**: Пользователь не авторизован в системе.
**Постусловия**: Пользователь авторизован в системе в качестве студента или преподавателя.

**Сценарий 2**.
1.  Пользователь нажимает кнопку "Войти".
2.  Пользователь вводит необходимые данные: адрес электронной почты и пароль.
3.  Система обращается к Базе данных пользователей.
4.  База данных пользователей осуществляет поиск соотвующей учётной записи пользователя.
5.  В случае успеха, Система авторизует пользователя.

**Сценарий 2а**.
1. В случае неуспешного поиска, Система выводит пользователю сообщение о некорректности введённых им данных.

## 3.3. Восстановление пароля

**Основной актор**: Неавторизованный пользователь.
**Вспомогательный актор**: База данных, Система.
**Контекст использования**: Восстановить пароль учётной записи пользователя.
**Предусловия**: Пользователю известен адрес электронной почты, который он указал при регистрации.
**Постусловия**: Пользователь получает новый пароль для авторизации в системе.

**Сценарий 3**.
1.  Пользователь нажимает кнопку "Восстановление пароля".
2.  Пользователь вводит адрес электронной почты, который он указал при регистрации.
3.  Система обращается к Базе данных пользователей.
4.  База данных пользователей осуществляет поиск соотвующую учётную запись пользователя.
5.  В случае успеха, Система генерирует новый пароль и отправляет электронное письмо на указанный адрес электронной почты, содержащее этот пароль.
6.  База данных пользователей обновляет учётную запись пользователя в соответствии с внесёнными изменениями.
7.  Пользователю демонстрируется сообщение о том, что новый пароль был отправлен по указанному им электронному адресу.

**Сценарий 3а**.
1. В случае неуспешного поиска, пользователю демонстрируется сообщение о том, что новый пароль был отправлен по указанному им электронному адресу, однако сообщения по этому электронному адресу не отправляется.

## 3.4. Создание теста

**Основной актор**: Преподаватель.
**Вспомогательный актор**: База данных, Система.
**Контекст использования**: Создать тест.
**Предусловия**: Преподаватель находится на странице личного кабинета и хочет создать тест.
**Постусловия**: Создаётся новый тест.

**Сценарий 4**.
1. Преподаватель нажимает кнопку "Создать тест".
2. Система отображает диалоговое окно с предложением ввести название теста.
3. Преподаватель вводит желаемое название теста.
4. Система обращается к Базе данных тестов.
5. База данных тестов создаёт запись о новом тесте.
6. Система уведомляет пользователя об успешном завершении операции добавлением созданного теста в список тестов, созданных данным преподавателем.

**Сценарий 4а**.
1. При попытке отправки запроса система обнаруживает отсутствие соединения с сетью.
2. Система демонстрирует пользователю уведомление с описанием ошибки.

## 3.5. Редактирование теста

**Основной актор**: Преподаватель.
**Вспомогательный актор**: База данных, Система.
**Контекст использования**: Редактировать содержимое теста.
**Предусловия**: Преподаватель находится на странице личного кабинета и хочет изменить содержимое теста.
**Постусловия**: Содержимое теста изменяется.

**Сценарий 5**.
1. Преподаватель нажимает соответствующую нужному тесту кнопку "Редактировать".
2. Система отображает пользователю страницу редактирования теста и отображает ему элементы управления содержимым теста.
3. Пользователь вносит необходимые изменения в содержимое теста с помощью предоставленных ему элементов управления.
4. Пользователь нажимает кнопку "Сохранить изменения".
5. Система проверяет корректность внесённых изменений:
    - Каждое множество альтернатив тестовых заданий должно быть непустым;
    - Каждому тестовому заданию должен быть задан правильный ответ;
    - Текст каждого тестового задания должен быть непустым;
    - Ограничение по времени выполнения теста должно быть неотрицательным числом;
    - Ограничение по количеству попыток выполнения теста должно быть положительным числом.
6. В случае успешной проверки Система обращается к Базе данных тестов.
7. База данных тестов обновляет запись о редактируемом тесте.
8. Система отображает пользователю страницу его личного кабинета и уведомление о том, что изменения успешно сохранены.

**Сценарий 5а**.
1. При проверке корректности внесённых изменений Система обнаружила невыполнение одного или нескольких обозначенных выше пунктов.
2. Система демонстрирует пользователю уведомление, содержащее информацию о всех допущенных им ошибках.

**Сценарий 5b**.
1. Пользователь нажимает кнопку "Отменить изменения".
2. Система запрашивает у пользователя подтверждение этого действия с уведомлением о том, к каким последствиям это может привести.
3. Пользователь подтверждает своё действие.
4. Система отображает пользователю страницу его личного кабинета без модификации записей в базе данных.

**Сценарий 5с**.
1. Пользователь нажимает кнопку "Отменить изменения".
2. Система запрашивает у пользователя подтверждение этого действия с уведомлением о том, к каким последствиям это может привести.
3. Пользователь отказывается подтвердить своё действие.
4. Система скрывает запрос подтверждения действия, предоставляя пользователю возможность далее вносить изменения в тест.

**Сценарий 5d**.
1. После успешной проверки внесённых изменений на корректность, Система обнаруживает отсутствие соединения с сетью.
2. Система демонстрирует пользователю уведомление с описанием возникшей неполадки.

## 3.6. Удаление теста

**Основной актор**: Преподаватель.
**Вспомогательный актор**: База данных, Система.
**Контекст использования**: Удалить тест.
**Предусловия**: Преподаватель находится на странице личного кабинета и хочет удалить созданный ранее тест.
**Постусловия**: Тест удаляется из Системы.

**Сценарий 6**.
1. Преподаватель нажимает соответствующую нужному тесту кнопку "Удалить".
2. Система демонстрирует преподавателю уведомление с описанием возможных последствий выполнения данного действия и просит пользователя подтвердить своё намерение.
3. Пользователь подтверждает своё намерение.
4. Система обращается к Базе данных тестов.
5. База данных тестов удаляет соответствующую запись о тесте.
6. Система убирает соответствующую запись о тесте из списка созданных данным преподавателем тестов.

**Сценарий 6а.**
1. Преподаватель отказывается от своего намерения.
2. Система скрывает показанное ранее уведомление.

**Сценарий 6b**.
1. После подтверждения пользователем его намерения, Система обнаруживает отсутствие соединения с сетью.
2. Система демонстрирует пользователю уведомление с описанием возникшей неполадки.

## 3.7. Изменение данных профиля.

**Основной актор**: Авторизованный пользователь.
**Вспомогательный актор**: База данных, Система.
**Контекст использования**: Изменить данные профиля.
**Предусловия**: Пользователь находится на странице личного кабинета и хочет изменить данные своего профиля.
**Постусловия**: Обновлённые данные профиля сохраняются в Системе.

**Сценарий 7**.
1. Пользователь нажимает кнопку "Редактировать данные", соответствующую одному из следующих полей:
    - Для пользователя категории Студент:
        - ФИО
        - Название учебного заведения
        - Курс
        - Факультет
        - Учебная группа
    - Для пользователя категории Преподаватель:
        - ФИО
        - Название учебного заведения
2. Система демонстрирует пользователю элемент управления, позволяющий изменить выбранное значение.
3. Пользователь вносит изменения в значение выбранного поля и нажимает кнопку "Сохранить изменения".
4. Система проверяет корректность внесённых изменений:
    - ФИО не может быть пустой строкой;
    - Учебная группа не может быть пустой строкой;
    - Название учебного заведения не может быть пустой строкой.
5. При успешной проверке корректности внесённых изменений, Система обращается к Базе данных пользователей.
6. База данных пользователей обновляет данные соответствующей записи.
7. Система демонстрирует пользователю уведомление об успешном внесении изменений.

**Сценарий 7а**.
1. После внесения изменений в значение выбранного поля пользователь нажимает кнопку "Отменить изменения".
2. Система скрывает элементы управления, позволяющие изменить значение выбранного поля. Внесённые изменения не сохраняются.

**Сценарий 7b**.
1. После проверки изменений на корректность, Система обнаруживает отсутствие соединения с сетью.
2. Система демонстрирует пользователю уведомление с описанием возникшей неполадки.

## 3.8. Изменение пароля

**Основной актор**: Авторизованный пользователь.
**Вспомогательный актор**: База данных, Система.
**Контекст использования**: Изменить пароль пользователя.
**Предусловия**: Пользователь находится на странице личного кабинета и хочет изменить свой пароль для входа в Систему.
**Постусловия**: Новое значение пароля для входа в Систему заменяет старое.

**Сценарий 8**.
1. Пользователь нажимает кнопку "Изменить пароль".
2. Система запрашивает у пользователя его текущий пароль и значение его нового пароля.
3. Пользователь вводит запрошенные данные и нажимает кнопку "Изменить".
4. Система обращается к Базе данных пользователей и проверяет корректность введённых данных:
    - Введённое значение текущего пароля и хранящееся в Базе данных пользователей значение пароля пользователя должны совпадать.
    - Длина нового пароля пользователя должна быть не меньше четырёх символов.
5. При успешной проверке, Система запоминает введённое пользователем значение нового пароля, но не заменяет им текущее: пользователь всё ещё должен проходить авторизацию с использованием старого пароля.
6. Система отправляет на электронный адрес пользователя, указанный при регистрации, информирующее о попытке смены пароля электронное сообщение, содержащее специальным образом сформированную гиперссылку.
7. Система демонстрирует пользователю уведомление о том, что для продолжения ему необходимо прочесть указанное электронное сообщение.
8. Пользователь читает указанное электронное сообщение и переходит по специальным образом сформированной гиперссылке в период до 72 часов с момента отправки сообщения.
9. Система определяет переход по гиперссылке и заменяет старое значение пароля новым.
10. Пользователю предлагается авторизоваться с обновлёнными учётными данными.

**Сценарий 8а**.
1. Во время ввода запрашиваемых данных пользователь нажимает кнопку "Отменить".
2. Система скрывает запрос на ввод данных. Внесённые изменения не сохраняются.

**Сценарий 8b**.
1. При неуспешной проверке корректности введённых данных, Система демонстрирует пользователю уведомление с описанием допущенных ошибок.

**Сценарий 8с**.
1. После проверки изменений на корректность, Система обнаруживает отсутствие соединения с сетью.
2. Система демонстрирует пользователю уведомление с описанием возникшей неполадки.

**Сценарий 8d**.
1. Пользователь не переходит по специально сформированной гиперссылке в течение 72 часов.
2. Система удаляет сохранённое значение нового пароля пользователя.
3. Система отправляет по электронному адресу пользователя электронное сообщение, уведомляющее его о недействительности специально сформированной гиперссылки.

**Сценарий 8е**.
1. Пользователь переходит по специально сформированной гиперссылке по истечении 72 часов.
2. Система демонстрирует пользователю веб-страницу с уведомлением, что запрошенной страницы не существует в Системе.

## 3.9. Просмотр результатов тестирования

**Основной актор**: Преподаватель.
**Вспомогательный актор**: База данных, Система.
**Контекст использования**: Просмотреть результаты тестирования.
**Предусловия**: Преподаватель находится на странице личного кабинета и хочет просмотреть результаты тестирования.
**Постусловия**: Преподавателю демонстрируются результаты тестирования.

**Сценарий 9**.
1. Преподаватель нажимает кнопку "Результаты" соответствующего теста.
2. Система обращается к Базе данных результатов за необходимыми данными.
2. Система демонстрирует преподавателю веб-страницу со всеми результатами прохождения выбранного теста и указанием количества совершённых попыток.

**Сценарий 9а**.
1. Преподаватель нажимает кнопку "Добавить результаты" на странице с результатами некоторого теста.
2. Система обращается к Базе данных тестов для получения списка созданных преподавателем тестов.
3. Система демонстрирует преподавателю список созданных им тестов.
4. Преподаватель выбирает один или несколько тестов из списка и нажимает кнопку "Отобразить".
5. Система обращается к Базе данных результатов за необходимыми данными.
6. Система скрывает список созданных преподавателем тестов и демонстрирует преподавателю все результаты прохождения всех выбранных им тестов с указанием количества совершённых попыток.

**Сценарий 9b**.
1. Системе не удаётся получить список созданных преподавателем тестов или результаты прохождения выбранного(-ых) теста(-ов) из-за отсутствия соединения с сетью.
2. Система демонстрирует пользователю уведомление с описанием возникшей неполадки.

**Сценарий 9с**.
1. Преподаватель нажимает кнопку "Экспорт результатов".
2. Система формирует файл в формате *.xlsx* со всеми отображаемыми результатами тестирований.
3. Система предоставляет преподавателю гиперссылку на скачивание файла.
4. По истечении 24 часов система закрывает доступ к файлу и удаляет его.

## 3.10. Отправка приглашений на тестирование

**Основной актор**: Преподаватель.
**Вспомогательный актор**: База данных, Система.
**Контекст использования**: Отправить приглашение на прохождение тестирования.
**Предусловия**: Преподаватель находится на странице личного кабинета и хочет пригласить студентов на прохождение тестирования.
**Постусловия**: Выбранным студентам отправляются уведомление о приглашении.

**Сценарий 10**.
1. Преподаватель нажимает кнопку "Пригласить" для соответствующего теста.
2. Система запрашивает у преподавателя список адресов электронной почты студентов.
3. Преподаватель вводит все необходимые адреса электронной почты.
4. Система проверяет все электронные адреса на корректность (согласно стандарту RFC 5322).
5. В случае успешной проверки, Система обращается к Базе данных приглашений.
6. База данных приглашений создаёт записи о новом приглашении на тестировании для каждого электронного адреса из списка.
7. Система отправляет электронные сообщения, содержащие информацию о тесте и гиперссылку на веб-страницу, на которой можно осуществить его прохождение, на каждый адрес электронной почты из списка.
8. Система демонстрирует преподавателю сообщение об успешной отправке приглашений.

**Сценарий 10а**.
1. Система обнаруживает некорректный адрес электронной почты в списке.
2. Преподаватель уведомляется о некорректности введённого адреса электронной почты.
3. Отправка приглашений не производится ни на один из списка указанных адресов.

**Сценарий 10b**.
1. Системе не удаётся обратиться к Базе данных из-за отсутствия соединения с сетью.
2. Система демонстрирует пользователю уведомление с описанием возникшей неполадки.

## 3.11. Принятие приглашения на тестирование

**Основной актор**: Студент.
**Вспомогательный актор**: База данных, Система.
**Контекст использования**: Принять или отклонить приглашение на прохождение тестирования.
**Предусловия**: Студент находится на странице личного кабинета и хочет принять или отклонить приглашение на тестирование.
**Постусловия**: Студент принимает или отклоняет приглашение на тестирование.

**Сценарий 11**.
1. Студент нажимает кнопку "Принять приглашение" для соответствующего приглашения.
2. Система обращается к Базе данных приглашений.
3. База данных приглашений удаляет запись о соответствующем приглашении.
4. Система обращается к Базе данных результатов тестирования.
5. База данных результатов тестирования создаёт запись, означающую осуществление данным студентом 0 попыток прохождения соответствующего теста.
6. Система демонстрирует студенту кнопку "Начать тестирование".

**Сценарий 11а**.
1. Студент нажимает кнопку "Начать тестирование".
2. Система демонстрирует студенту веб-страницу, позволяющую пройти тестирование.

**Сценарий 11b**.
1. Студент нажимает кнопку "Отклонить приглашение".
2. Система обращается к Базе данных приглашений.
3. База данных приглашений удаляет запись о соответствующем приглашении.
4. Система демонстрирует студенту кнопку "Заблокировать пригласителя".

**Сценарий 11с**.
1. Студент нажимает кнопку "Заблокировать пригласителя".
2. Система обращается к Базе данных чёрных списков.
3. База данных чёрных списков создаёт запись о добавлении преподавателя в чёрный список данного студента.
4. Система демонстрирует студенту уведомление об успешном выполнении действия.

**Сценарий 11d**.
1. Системе не удаётся обратиться к Базе данных из-за отсутствия соединения с сетью.
2. Система демонстрирует студенту уведомление с описанием возникшей неполадки.

## 3.12. Прохождение тестирования

**Основной актор**: Студент.
**Вспомогательный актор**: База данных, Система.
**Контекст использования**: Пройти тестирование.
**Предусловия**: Студент находится на веб-странице прохождения тестирования.
**Постусловия**: Студент совершает попытку прохождения теста.

**Сценарий 12**.
1. Студент нажимает кнопку "Начать тестирование".
2. Система обращается к Базе данных попыток тестирования.
3. База данных находит количество оставшихся попыток на прохождение теста.
4. Система отображает студенту количество оставшихся у него попыток на прохождение теста.
5. Если это количество больше 0, Система обращается к Базе данных попыток тестирования.
6. База данных попыток тестирования создаёт запись о начале прохождения тестирования студентом с указанием времени начала тестирования.
7. Система отображает студенту текст первого тестового задания из содержимого теста, элементы управления для ввода ответа на тестовое задание, средство навигации по тестовым заданиям и таймер оставшегося времени (в случае наличия ограничения по времени).
8. Студент использует предоставленные ему элементы управления для дачи ответов на тестовые задания.
9. Студент нажимает кнопку "Завершить тестирование".
10. Система демонстрирует студенту уведомление о последствиях его действий и запрашивает подтверждение намерения студента завершить тестирование.
11. Студент подтверждает намерение.
12. Система создаёт результат тестирования путём сверки ответов, данных студентом, с правильными ответами.
13. Система обращается к Базе данных результатов тестирования.
14. База данных результатов тестирования получает информацию о предыдущем результате тестирования.
15. Система сравнивает количество правильных ответов в предыдущем и текущем результатах тестирования.
16. Система обращается к Базе данных результатов тестирования с результатом тестирования, имеющим большее количество правильных ответов.
17. База данных результатов тестирования обновляет запись о результате тестирования.
18. Система демонстрирует пользователю веб-страницу с его текущим результатом тестирования.

**Сценарий 12а**.
1. Студент не нажимает кнопку "Завершить тестирование" до истечения ограничения по времени данного теста.
2. Система демонстрирует студенту уведомление о исчерпании лимита времени на прохождение теста.
3. Выполняются пункты 9.-15. **Сценария 12**.

**Сценарий 12b**.
1. Системе не удаётся обратиться к Базе данных из-за отсутствия соединения с сетью.
2. Система демонстрирует студенту уведомление с описанием возникшей неполадки.

**Сценарий 12с**.
1. Если количество оставшихся попыток на прохождение тестирования равно 0, система демонстрирует пользователю уведомление о невозможности прохождения данного теста.

## 3.13. Редактирование чёрного списка

**Основной актор**: Студент.
**Вспомогательный актор**: База данных, Система.
**Контекст использования**: Редактировать чёрный список.
**Предусловия**: Студент находится на веб-странице личного кабинета.
**Постусловия**: Студент внёс необходимые правки в свой чёрный список.

**Сценарий 13**.
1. Студент нажимает кнопку "Редактировать чёрный список".
2. Система обращается к Базе данных чёрных списков.
3. База данных чёрных списков находит все записи о заблокированных студентом преподавателях.
4. Система демонстрирует студенту список заблокированных им преподавателей.
5. Студент нажимает кнопку "Убрать из чёрного списка".
6. Система обращается к Базе данных чёрных списков.
7. База данных чёрных списков удаляет соответствующую запись о заблокированном преподавателе.
8. Система демонстрирует пользователю уведомление о успешном проведении операции удаления.

**Сценарий 13а**.
1. Системе не удаётся обратиться к Базе данных из-за отсутствия соединения с сетью.
2. Система демонстрирует студенту уведомление с описанием возникшей неполадки.
